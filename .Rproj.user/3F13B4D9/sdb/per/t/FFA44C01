{
    "collab_server" : "",
    "contents" : "# install.packages(\"flexclust\")\n#library(stats)\nlibrary(flexclust)\nlibrary(cluster)\nlibrary(fpc)\n\nclusterdataf = datafexam # select the dataframe to use for clustering\n\n\n#### K-MEANS EUCLIDEAN CLUSTERING ####\n\n# Creating the kmeans object\n# kmeansClusters = kmeans(clusterdataf, centers = 5)\n\nkmeansClusters = stepFlexclust(clusterdataf, k = 3, nrep = 10000, FUN = cclust, multicore = TRUE)\n\nsummary(kmeansClusters)\n\nkcenters = kmeansClusters@centers \ndaisy(kcenters, metric = \"manhattan\") # distances beetween the cluster centers\n\nkgroup_3 = kmeansClusters@cluster\n\n\n#### DIFFERENT K k-MEANS CLUSTERING ####\n\n### For 2 to 15 clusters \nkmeansClusters_rep = stepFlexclust(clusterdataf, k = 2:8, nrep = 600, FUN = cclust, multicore = TRUE)\n\n\n#########################################\n#### Choosing the number of clusters ####\n#########################################\n\nplot(kmeansClusters_rep) # from the within sum of squares, we see that it become stable after 2/3 clusters \n\npar(mfrow = c(1,3))\nfor(i in 1:3){\n  print(cluster.stats(distances, kmeansClusters_rep[[i]]@cluster))\n  plot(silhouette(kmeansClusters_rep[[i]]@cluster, distances), cex.names=0.6)\n}\n\n# according to the average silhouette, we choose three clusters\n\n\n\n#####################################\n##### ON REDUCED DATAFRAME ##########\n#####################################\n\nlibrary(flexclust)\nlibrary(fpc)\nlibrary(cluster)\n\nclusterdataf = datafexam_reduced\nkmeansClusters_rep_reduced = stepFlexclust(clusterdataf, k = 2:8, nrep = 1000, FUN = cclust, multicore = TRUE)\nplot(kmeansClusters_rep_reduced) # from the within sum of squares, we see that it become stable after 2 or 3 clusters \n\ndistances_reduced = daisy(clusterdataf, \n                    type = list(asymm = c(1:ncol(datafexam_reduced))), # threating the variables as asymmetric binaries\n                    metric = \"gower\")\n\n# average silhouette width stats\n\npar(mfrow = c(1,3))\nfor(i in 1:3){\n  print(cluster.stats(distances_reduced, kmeansClusters_rep_reduced[[i]]@cluster))\n  plot(silhouette(kmeansClusters_rep_reduced[[i]]@cluster, distances_reduced), cex.names=0.6)\n}\n\n\nmostFollowed_byclust(kmeansClusters_rep_reduced[[1]]@cluster, percentage = 0.5) # looking frequencies inside two clusters\n\n\n\n#### MORE THAN TWO GROUPS ####\n\n\nmostFollowed_byclust(kmeansClusters_rep_reduced[[2]]@cluster, percentage = .5) # 3 clusters\nmostFollowed_byclust(kmeansClusters_rep_reduced[[3]]@cluster, percentage = .5) # 4 clusters\n\n\n\n",
    "created" : 1496763637570.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2904527234",
    "id" : "FFA44C01",
    "lastKnownWriteTime" : 1496930682,
    "last_content_update" : 1496930682308,
    "path" : "D:/Box Sync/#UNI/Materiale tesi/Analysis/ThesisAnalysis/R/kmeans.R",
    "project_path" : "R/kmeans.R",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}