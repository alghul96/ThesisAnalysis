{
    "collab_server" : "",
    "contents" : "library(cluster)\nlibrary(stats)\n\n#### HIERARCHICAL CLUSTER COMPUTATION ####\n\nclusterdataf = datafexam # select the dataframe to use for clustering\n\ndistances = daisy(clusterdataf, \n                  type = list(asymm = c(1:ncol(clusterdataf))), # threating the variables as asymmetric binaries\n                  metric = \"gower\")\n\n\nComplClusters = hclust(distances, method = \"complete\")\nWardClusters = hclust(distances, method = \"ward.D\") # threating the variables as numeric\n\nWardClusters = agnes(distances, diss = TRUE, method = \"ward\")\n\n#### IDENTIFYING MOST FOLLOWED COURSES IN CLUSTERS ####\n\n# The following code produces an interactive deindogram showing the most followed\n# exams for each group of variables considered\n\n\n# building a function to see most followed exam names given a vector of students\n\nmostFollowed = function(k, percentage = 0.7){\n  \n  course_freq = apply(clusterdataf[k, ], 2, mean)\n  is_popular = (course_freq >= percentage) & (course_freq <= 1) # seeing which courses are more frequent\n  \n  most_followed = course_freq[is_popular] # selection of the courses\n  most_followed_ordered = most_followed[order(course_freq[is_popular], decreasing = T)] # ordering\n  \n  print(length(k))\n  print(as.data.frame(most_followed_ordered))\n  cat(\"____________________________________________________________________\\n\")\n\n}\n\n\n#### Plotting an interactive deindogram to see the courses\n\n# Complete method\nplot(ComplClusters, labels = other_info$immyear)\nidentify(ComplClusters, mostFollowed) # click over a branch to see the most followed courses!\n\n# Ward method\nplot(WardClusters, labels = other_info$immyear)\nidentify(WardClusters, mostFollowed) # click over a branch to see the most followed courses!\n\n\nhist(cutree(ComplClusters, h = .83))\n\n\n\n\n### DATA REPRESENTATION ###\n\n#install.packages(\"dendextend\")\n#install.packages(\"circlize\")\nlibrary(dendextend)\nlibrary(circlize)\n\n# create a dendrogram\ndend <- as.dendrogram(ComplClusters)\n\n# modify the dendrogram to have some colors in the branches and labels\ndend <- dend %>% \n  color_branches(k=4) %>% \n  color_labels\n\n# plot the radial plot\npar(mar = rep(0,4))\ncirclize_dendrogram(dend, labels_track_height = NA, dend_track_height = .9, labels = FALSE)\n\n\n# NOTES FOR THE PAPER\n# first two merged\nclusterdataf[c(38,110),]\nas.matrix(distances)[\"0000439075\",\"0000434475\"]\n\n# first two with a distance different from 0\nWardClusters$height[8]\nWardClusters$merge[8]\n\nclusterdataf[c(129,165),]\nas.matrix(distances)[\"0000365303\",\"0000364326\"] # those two differs just for RETI DI TELECOMUNICAZIONI M\n\n# the first unit merged to a cluster was unit 212, at stage 35, with a distance from cluster of 322\nWardClusters$merge[35, ]\nWardClusters$height[35]\n\n# complete height\nComplClusters$height[27]\nmax(as.matrix(distances)[\"0000364326\", \"0000366086\"])\n\ncbind(\n  t(clusterdataf[c(129,165, 222),]),\n  apply(clusterdataf[c(129,165, 212),], 2, mean),\n  apply(clusterdataf[c(129,165, 212),], 2, var))\n",
    "created" : 1494490055699.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "826228527",
    "id" : "B110A008",
    "lastKnownWriteTime" : 1494945763,
    "last_content_update" : 1494945763987,
    "path" : "D:/Box Sync/#UNI/Materiale tesi/Analysis/ThesisAnalysis/hierarchicalclust.R",
    "project_path" : "hierarchicalclust.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}