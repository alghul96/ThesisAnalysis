{
    "collab_server" : "",
    "contents" : "library(spatstat)\nlibrary(fpc)\n\nresults = list(hgroup_3, kgroup_3, kmedgroup_3, other_info[,3])\n\ncourses_mixtgroup = mostFollowed_byclust(other_info[,3], percentage = 0.7) # exam frequentation in mixture-model clusters\ncourses_kmeagroup = mostFollowed_byclust(kgroup_3, percentage = 0.7) # in k-means clusters\ncourses_hgroup = mostFollowed_byclust(hgroup_3, percentage = 0.7) # in hierarchical clusters\ncourses_kmedgroup = mostFollowed_byclust(kmedgroup_3, percentage = 0.7) # in k-medoids\n\n\nexam_frequencies = list(courses_hgroup, courses_kmeagroup, courses_kmedgroup, courses_mixtgroup)\n\n\n###############################\n#### RESULTS COMPARISONS ######\n###############################\n\npar(mfrow = c(2,2))\nfor(i in results){\n  hist(i, main = \"\")\n}\n\n\ncomparison = cbind(courses_mixtgroup[2:3], courses_kmeagroup[2:1], courses_hgroup[1:2], courses_kmedgroup[1:2])\n\nround(comparison, 2) # comparing the two major clusters\n\n\n### MEDOIDS/PROTOTYPES COMPARISON\n\npar(mfrow = c(3,1))\nimage(round(t(kcenters)), axes = FALSE, main = \"K-means Centroids\")\nabline(h = c(.25, .75), col = 0)\ntext(x = .8, y = seq(0, 1, l = 3), labels = c(\"Sist. e Reti\", \"Intell. Art.\", \"Vecchio Ord.\"), col = \"0\")\n\nimage(mixtprototypes[, c(3,2,1)], axes = FALSE, main = \"Mixture-Model Prototypes\")\nabline(h = c(.25, .75), col = 0)\ntext(x = .8, y = seq(0, 1, l = 3), labels = c(\"Sist. e Reti\", \"Intell. Art.\", \"Vecchio Ord.\"), col = \"0\")\n\nimage(t(clusterdataf[kmedoidsClusters$medoids,]), axes = FALSE, main = \"K-medoids Medoids\")\nabline(h = c(.25, .75), col = 0)\ntext(x = .8, y = seq(0, 1, l = 3), labels = c(\"Sist. e Reti\", \"Intell. Art.\", \"Vecchio Ord.\"), col = \"0\")\n\n\n###########################################\n##### CHOOSING THE NUMBER OF CLUSTERS #####\n###########################################\n\n# Average silhouette for different clustering methods\n\nfor(i in results){\n  print(\"_________________________\")\n  print(cluster.stats(distances, i))\n  plot(silhouette(i, distances), cex.names=0.6)\n  \n}\n\n\n# Jaccard similarity coefficient\n\ntemp = clusterboot(clusterdataf, clustermethod = kmeansCBI, krange = 3)\nplot(temp)\ntemp = temp$result$partition\n\nmostFollowed_byclust(temp, .5)\nplot(silhouette(temp, distances))\nrm(temp)\n\n\n\n##############################\n#### CLUSTER COMPOSITION #####\n##############################\n\nplot(\n  as.im(as.matrix(courses_mixtgroup), \n        W = owin(c(1,90), c(1,140))),\n  main = \"Courses Frequencies Beetween Clusters\")\nabline(v = c(30.5, 60.5), col = \"white\", lwd = 2)\n\n       \n# Vediamo come quelli del terzo cluster sono quelli di anni precedenti alle immatricolazioni del 2012 \ntable(other_info[,1], clustergroup[,3])\n\nmost_frequented_byclust = courses_mixtgroup[apply(courses_mixtgroup, 1, sum) > 0.3,]\n\n\n###########################\n#### REDUCED DATAFRAME ####\n###########################\n\ncourses_mixtgroup_red = mostFollowed_byclust(mixtgroup_reduced, X = datafexam_reduced, verbose = F)\n\nplot(courses_mixtgroup_red)\n\nmost_frequented_byclust_red = courses_mixtgroup_red[apply(courses_mixtgroup_red, 1, sum) > 0.2,]\n\n",
    "created" : 1497005135740.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3532816782",
    "id" : "B0717658",
    "lastKnownWriteTime" : 1497006700,
    "last_content_update" : 1497006700401,
    "path" : "D:/Box Sync/#UNI/Materiale tesi/Analysis/ThesisAnalysis/R/group_anal.R",
    "project_path" : "R/group_anal.R",
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}